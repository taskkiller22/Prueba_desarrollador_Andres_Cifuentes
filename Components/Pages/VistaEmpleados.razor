@page "/empleados"
@using Prueba_desarrollador_Andres_Cifuentes.Interfaces
@using Prueba_desarrollador_Andres_Cifuentes.Models
@inject IEmpleados EmpleadosService
@inject NavigationManager Nav

<h3>Empleados</h3>

<button class="btn btn-primary" @onclick="IrCrear">Nuevo Empleado</button>

@if (empleados == null)
{
    <p>Cargando...</p>
}
else if (!empleados.Any())
{
    <p>No hay empleados registrados.</p>
}
else
{
    <ul class="list-group">
        @foreach (var e in empleados)
        {
            <li class="list-group-item d-flex justify-content-between align-items-center">
                <span>@e.Nombre - @e.Posicion</span>
                <div>
                    <button class="btn btn-info btn-sm me-1" @onclick="() => IrDetalle(e.Id)">Ver</button>
                    <button class="btn btn-warning btn-sm me-1" @onclick="() => IrEditar(e.Id)">Editar</button>
                    <button class="btn btn-danger btn-sm" @onclick="() => Eliminar(e.Id)">Eliminar</button>
                </div>
            </li>
        }
    </ul>
}

@code {
    private List<EmpleadosModel>? empleados;

    protected override async Task OnInitializedAsync()
    {
        await CargarEmpleadosAsync();
    }

    private async Task CargarEmpleadosAsync()
    {
        empleados = await EmpleadosService.GetAllAsync();
    }

    private void IrCrear()
        => Nav.NavigateTo("/empleados/crear");

    private void IrDetalle(int id)
        => Nav.NavigateTo($"/empleados/detalle/{id}");

    private void IrEditar(int id)
        => Nav.NavigateTo($"/empleados/editar/{id}");

    private async Task Eliminar(int id)
    {
        await EmpleadosService.DeleteAsync(id);
        await CargarEmpleadosAsync();
    }
}
